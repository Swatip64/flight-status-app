(this["webpackJsonpflight-status-app"]=this["webpackJsonpflight-status-app"]||[]).push([[0],{15:function(e,t,a){e.exports=a(29)},22:function(e,t,a){},24:function(e,t,a){},29:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),r=a(14),c=a.n(r),l=(a(22),a(23),a(24),a(31));var i=()=>{const[e,t]=Object(n.useState)([]),[a,r]=Object(n.useState)("");Object(n.useEffect)(()=>{(async()=>{try{const e=await l.a.get("/api/flight-status");Array.isArray(e.data)?t(e.data):console.error("Expected an array but got:",e.data)}catch(e){console.error("Error fetching flight data:",e)}})();const e=new WebSocket("ws://localhost:5000/updates");return e.onmessage=e=>{try{const a=JSON.parse(e.data);Array.isArray(a)?t(e=>e.map(e=>a.find(t=>t.id===e.id)||e)):console.error("Expected an array but got:",a)}catch(a){console.error("Error processing WebSocket message:",a)}},e.onerror=e=>{console.error("WebSocket error:",e)},()=>{e.close()}},[]);const c=e.filter(e=>e.flightNumber.toLowerCase().includes(a.toLowerCase()));return o.a.createElement("div",{className:"flight-status-dashboard"},o.a.createElement("h2",null,"Flight Status Dashboard"),o.a.createElement("input",{type:"text",placeholder:"Search flights",value:a,onChange:e=>r(e.target.value)}),o.a.createElement("table",{className:"table"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Flight Number"),o.a.createElement("th",null,"Status"),o.a.createElement("th",null,"Gate"),o.a.createElement("th",null,"Arrival Time"),o.a.createElement("th",null,"Boarding Time"))),o.a.createElement("tbody",null,c.length>0?c.map(e=>o.a.createElement("tr",{key:e.id},o.a.createElement("td",null,e.flightNumber),o.a.createElement("td",null,e.status),o.a.createElement("td",null,e.gate),o.a.createElement("td",null,e.arrivalTime),o.a.createElement("td",null,e.boardingTime))):o.a.createElement("tr",null,o.a.createElement("td",{colSpan:"5"},"No flights available")))))};var s=()=>{const[e,t]=Object(n.useState)([]),[a,r]=Object(n.useState)({sms:!0,email:!0,app:!0});Object(n.useEffect)(()=>{(async()=>{try{const e=await fetch("/api/notifications"),a=await e.json();t(a.notifications)}catch(e){console.error("Error fetching notifications:",e)}})()},[]);const c=e=>{r(t=>({...t,[e]:!t[e]}))};return o.a.createElement("div",{className:"notifications-panel"},o.a.createElement("h2",null,"Notifications"),o.a.createElement("div",{className:"notification-settings"},o.a.createElement("label",null,o.a.createElement("input",{type:"checkbox",checked:a.sms,onChange:()=>c("sms")}),"SMS Notifications"),o.a.createElement("label",null,o.a.createElement("input",{type:"checkbox",checked:a.email,onChange:()=>c("email")}),"Email Notifications"),o.a.createElement("label",null,o.a.createElement("input",{type:"checkbox",checked:a.app,onChange:()=>c("app")}),"App Notifications")),o.a.createElement("div",{className:"notifications-list"},e.map(e=>o.a.createElement("div",{key:e.id,className:"notification"},e.message))))};var m=()=>o.a.createElement("div",{className:"app"},o.a.createElement("header",null,o.a.createElement("h1",null,"Flight Status and Notifications System")),o.a.createElement("main",null,o.a.createElement(i,null),o.a.createElement(s,null))),u=a(12),p=a(8);const d=Object(u.a)({apiKey:"AIzaSyBb0p9GdUeC9JKGtnOxWNQqlHhLRKN_UJU",authDomain:"flightstatusapp-49d34.firebaseapp.com",projectId:"flightstatusapp-49d34",storageBucket:"flightstatusapp-49d34.appspot.com",messagingSenderId:"378544592523",appId:"1:378544592523:web:e8b3a4c132793673ba668e",measurementId:"G-WNT7HT5Q1C"}),h=Object(p.a)(d),g=async()=>{try{const e=await Object(p.b)(h,{vapidKey:"BBA4c7wzHiOe90p1mmnTGQHeb7Td6N363N1VB1VuwVf_yFIVOB2F1OA3kK0WF00STSRKkwN6hBm08pgI_N9DOJM"});e?(console.log("Device token:",e),f(e)):console.log("No registration token available. Request permission to generate one.")}catch(e){console.error("An error occurred while retrieving token. ",e)}},f=async e=>{try{(await fetch("/send-notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})})).ok?console.log("Token successfully sent to the server"):console.error("Failed to send token to server")}catch(t){console.error("Error sending token to server:",t)}};Object(p.c)(h,e=>{console.log("Message received. ",e),alert("Notification: ".concat(e.notification.title," - ").concat(e.notification.body))}),(async()=>{try{"granted"===await Notification.requestPermission()?(console.log("Notification permission granted."),g()):console.log("Unable to get permission to notify.")}catch(e){console.error("Error requesting notification permission:",e)}})(),c.a.render(o.a.createElement(m,null),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.a4199388.chunk.js.map